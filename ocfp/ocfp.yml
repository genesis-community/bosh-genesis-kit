---
meta:
  env:
    name:  (( grab $GENESIS_ENVIRONMENT ))
    slug:  (( grab $GENESIS_SECRETS_SLUG ))
    scale: (( grab params.env.scale || "dev" ))

  vault:
    mount:       (( grab $GENESIS_SECRETS_MOUNT ))
    exodus_path: (( grab $GENESIS_EXODUS_MOUNT ))
    tf_path:     (( concat meta.vault.mount "tf/" meta.env.slug ))
    env_path:    (( concat meta.vault.mount meta.env.slug ))
    certs_path:  (( concat meta.vault.mount "certs" ))

  trusted_certs:
    - (( vault meta.vault.certs_path "/org:ca" )) # Organization CA, if exists
    - (( vault meta.vault.certs_path "/dbs:ca" )) # External Databases CA

params: # TODO: ocfp-no-trusted-certs.yml
  trusted_certs: (( join "" meta.trusted_certs ))

  # Required for add-secrets
  ca_validity_period: "10y"
  cert_validity_period: "10y"

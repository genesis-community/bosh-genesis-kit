---
params:
  aws_ebs_encryption: true # Default to encrypted at rest
  persistent_disk_size: 64536

  # TODO: Q: How can we bypass the param queries if ocfp feature?
  # NOTE: The below are only to appease the merging of param items.
  aws_key_name: (( vault meta.ocfp.vault.tf "/keys/bosh:keypair_name" ))
  aws_region:   (( vault meta.ocfp.vault.tf "/iaas/region:name" ))
  aws_default_sgs: 
  - (( vault meta.ocfp.vault.tf "/iaas/sgs/default:id" ))
  - (( vault meta.ocfp.vault.tf "/iaas/sgs/ocf:id" ))

  static_ip:       (( vault meta.ocfp.vault.tf "/net/bosh:ip" ))
  default_gateway: (( vault meta.ocfp.vault.tf "/net/bosh:gateway" ))
  subnet_addr:     (( vault meta.ocfp.vault.tf "/iaas/subnets/ocfp/0:cidr_block" )) 
  aws_subnet_id:   (( vault meta.ocfp.vault.tf "/iaas/subnets/ocfp/0:id" ))

  bosh_network:   (( concat genesis.env "-bosh" ))
  bosh_vm_type:   (( concat "bosh-" meta.ocfp.env.scale ))
  bosh_disk_pool: (( concat "bosh-" meta.ocfp.env.scale ))

  availability_zones: 
    - (( concat genesis.env "-z1" ))

bosh-variables:
  az:            (( grab genesis.env "-z1" ))
  region:        (( vault meta.ocfp.vault.tf "/iaas/region:name" ))
  subnet_id:     (( vault meta.ocfp.vault.tf "/iaas/subnets/ocfp/0:id" ))
  internal_cidr: (( vault meta.ocfp.vault.tf "/iaas/subnets/ocfp/0:cidr_block" )) 
  internal_ip:   (( vault meta.ocfp.vault.tf "/net/bosh:ip" ))
  internal_gw:   (( vault meta.ocfp.vault.tf "/net/bosh:gateway" ))
  internal_dns: 
  - (( vault meta.ocfp.vault.tf "/net/bosh:dns" ))

  default_key_name: (( vault meta.ocfp.vault.tf "/keys/bosh:keypair_name" ))

  default_security_groups:
  - (( vault meta.ocfp.vault.tf "/iaas/sgs/default:id" ))
  - (( vault meta.ocfp.vault.tf "/iaas/sgs/ocf:id" ))
  
  private_key:       (( vault meta.ocfp.vault.tf "/keys/bosh:private" ))
  access_key_id:     (( vault meta.ocfp.vault.tf "/iam/bosh:access_key" ))
  secret_access_key: (( vault meta.ocfp.vault.tf "/iam/bosh:secret_key" ))

  s3-bucket-name:       (( vault meta.ocfp.vault.tf "/blobstores/bosh:name" ))
  s3-region:            (( vault meta.ocfp.vault.tf "/blobstores/bosh:region" ))
  s3-access-key-id:     (( vault meta.ocfp.vault.tf "/iam/s3:access_key" ))
  s3-secret-access-key: (( vault meta.ocfp.vault.tf "/iam/s3:secret_key" ))

  disk_size: (( grab params.persistent_disk_size ))

